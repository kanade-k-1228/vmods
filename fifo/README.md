# FIFO

FIFOを実装するには、リングバッファを使います。
リングバッファは、2つのポインタの追いかけっこです。

- write_ptr: 次はここに書き込んでね～！
- read_ptr: 次はここを読んでね～！

最初は、WとRは同じマスにいます。
書き込みが発生すると、Wはその場所にデータを置き、１マス進みます。
読み込みが発生すると、Rは１マス進み、データを回収します。
これがFIFOの基本です。

ここで２つの問題が発生します。
まず、FIFOが空のときにReadをしようとする場合です。
Rが１マス進むと、Wに追いついてしまいます。
ここはまだデータが書き込まれていないマスです。
（実際には謎の値が出力されますが、これは意図していない動作です。）

次に、FIFOが満杯の場合です。
Wがリングバッファを一周してRに追いつき、満杯に
FIFOが満杯のときにWriteすると、前のデータを上書きしてしまいます。

これらの問題を防止するために、empty_flagとfull_flagを作りましょう。
その名前の通り、empty_flagはFIFOが空であること、full_flagはFIFOが満杯であることを表します。
このフラグを計算するには、RとWの現在の位置からだけ計算できません。
上の図を見ると、emptyのときとfullのときのお互いの相対位置は、同じになっています。
Rが追い付いてきたのかＷが追い越したのかを識別するために、状態遷移の際にフラグをセットします。
